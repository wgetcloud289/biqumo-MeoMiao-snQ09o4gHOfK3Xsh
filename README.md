
å‡è®¯å¨åœ¨çº¿å®¢æœä¸è¥é”€ç³»ç»Ÿæ˜¯åŸºäº .net core / WPF å¼€å‘çš„ä¸€æ¬¾åœ¨çº¿å®¢æœè½¯ä»¶ï¼Œå®—æ—¨æ˜¯ï¼š **å¼€æ”¾ã€å¼€æºã€å…±äº«ã€‚åŠªåŠ›æ‰“é€  .net ç¤¾åŒºçš„ä¸€æ¬¾ä¼˜ç§€å¼€æºäº§å“ã€‚**


å‰æ®µæ—¶é—´æˆ‘å‘è¡¨äº†ä¸€ç³»åˆ—æ–‡ç« ï¼Œå¼€å§‹ä»‹ç»åŸºäº .net core çš„å‡è®¯å¨åœ¨çº¿å®¢æœç³»ç»Ÿå¼€å‘è¿‡ç¨‹ã€‚
éšæ—¶ Linux \+ MySQL çš„å¹¿æ³›åº”ç”¨ï¼Œ **å¿…é¡»è®©ç³»ç»ŸåŒæ—¶æ”¯æŒ SQL Server å’Œ MySQLã€‚**


## å¹¶è¡ŒæŸ¥è¯¢æŠ€æœ¯


å¹¶è¡Œ LINQ (PLINQ) æ˜¯è¯­è¨€é›†æˆæŸ¥è¯¢ (LINQ) æ¨¡å¼çš„å¹¶è¡Œå®ç°ã€‚ PLINQ å°†æ•´å¥— LINQ æ ‡å‡†æŸ¥è¯¢è¿ç®—ç¬¦å®ç°ä¸º System.Linq å‘½åç©ºé—´çš„æ‰©å±•æ–¹æ³•ï¼Œå¹¶æä¾›é€‚ç”¨äºå¹¶è¡Œæ“ä½œçš„å…¶ä»–è¿ç®—ç¬¦ã€‚ PLINQ å°† LINQ è¯­æ³•çš„ç®€æ´å’Œå¯é æ€§ä¸å¹¶è¡Œç¼–ç¨‹çš„å¼ºå¤§åŠŸèƒ½ç»“åˆåœ¨ä¸€èµ·ã€‚


### ä»€ä¹ˆæ˜¯å¹¶è¡ŒæŸ¥è¯¢


ä¸€ä¸ª PLINQ æŸ¥è¯¢çš„è®¸å¤šæ–¹é¢éƒ½ç±»ä¼¼äºéå¹¶è¡Œçš„ LINQ to Objects æŸ¥è¯¢ã€‚ ä¸é¡ºåº LINQ æŸ¥è¯¢ä¸€æ ·ï¼ŒPLINQ æŸ¥è¯¢å¯¹ä»»ä½•å†…å­˜ä¸­ IEnumerable æˆ– IEnumerable æ•°æ®æºæ‰§è¡Œæ“ä½œï¼Œå¹¶ä¸”æ¨è¿Ÿäº†æ‰§è¡Œï¼Œå³åœ¨æšä¸¾æŸ¥è¯¢å‰ä¸ä¼šå¼€å§‹æ‰§è¡Œã€‚ ä¸»è¦åŒºåˆ«åœ¨äºï¼ŒPLINQ ä¼šå°è¯•å……åˆ†åˆ©ç”¨ç³»ç»Ÿä¸Šçš„æ‰€æœ‰å¤„ç†å™¨ã€‚ æ–¹æ³•æ˜¯å°†æ•°æ®æºåˆ†åŒºæˆç‰‡æ®µï¼Œç„¶ååœ¨å¤šä¸ªå¤„ç†å™¨ä¸Šé’ˆå¯¹å•ç‹¬å·¥ä½œçº¿ç¨‹ä¸Šçš„æ¯ä¸ªç‰‡æ®µæ‰§è¡Œå¹¶è¡ŒæŸ¥è¯¢ã€‚ åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œå¹¶è¡Œæ‰§è¡Œæ„å‘³ç€æŸ¥è¯¢è¿è¡Œé€Ÿåº¦æ˜¾è‘—æé«˜ã€‚


é€šè¿‡å¹¶è¡Œæ‰§è¡Œï¼Œé€šå¸¸åªéœ€å‘æ•°æ®æºæ·»åŠ  AsParallel æŸ¥è¯¢æ“ä½œï¼ŒPLINQ å³å¯æ˜¾è‘—æå‡æ€§èƒ½ï¼ˆä¸æŸäº›ç±»å‹æŸ¥è¯¢çš„æ—§ä»£ç ç›¸æ¯”ï¼‰ã€‚ ä½†æ˜¯ï¼Œå¹¶è¡Œå¯èƒ½ä¼šå¼•å…¥å…¶è‡ªèº«çš„å¤æ‚æ€§ï¼Œå› æ­¤å¹¶éæ‰€æœ‰çš„æŸ¥è¯¢æ“ä½œçš„è¿è¡Œé€Ÿåº¦åœ¨ PLINQ ä¸­éƒ½æ›´å¿«ã€‚ äº‹å®ä¸Šï¼Œå¹¶è¡Œå®é™…ä¸Šä¼šé™ä½æŸäº›æŸ¥è¯¢çš„é€Ÿåº¦ã€‚ å› æ­¤ï¼Œåº”äº†è§£æ’åºç­‰é—®é¢˜å°†å¦‚ä½•å¯¹å¹¶è¡ŒæŸ¥è¯¢äº§ç”Ÿå½±å“ã€‚


### PLINQ æŸ¥è¯¢æ€§èƒ½çš„å½±å“å› ç´ 


ä¸‹é¢å„éƒ¨åˆ†åˆ—å‡ºäº†å¹¶è¡ŒæŸ¥è¯¢æ€§èƒ½çš„ä¸€äº›æœ€é‡è¦çš„å½±å“å› ç´ ã€‚ è¿™äº›éƒ½æ˜¯ä¸€èˆ¬æ€§è¯´æ˜ï¼Œæœ¬èº«å¹¶ä¸è¶³ä»¥ç”¨äºåœ¨æ‰€æœ‰æƒ…å†µä¸‹é¢„æµ‹æŸ¥è¯¢æ€§èƒ½ã€‚


1. æ•´ä½“å·¥ä½œçš„è®¡ç®—æˆæœ¬ã€‚
ä¸ºäº†å®ç°åŠ é€Ÿï¼ŒPLINQ æŸ¥è¯¢å¿…é¡»æœ‰è¶³å¤Ÿå¤šçš„é€‚åˆå¹¶è¡Œæ“ä½œæ¥æŠµæ¶ˆå¼€é”€ã€‚ å·¥ä½œå¯ä»¥è¡¨ç¤ºä¸ºæ¯ä¸ªå§”æ‰˜çš„è®¡ç®—æˆæœ¬ä¹˜ä»¥æºé›†åˆä¸­çš„å…ƒç´ æ•°é‡ã€‚ å‡è®¾æ“ä½œå¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Œå®ƒçš„è®¡ç®—æˆæœ¬è¶Šé«˜ï¼ŒåŠ é€Ÿçš„æœºä¼šå°±è¶Šå¤§ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœå‡½æ•°çš„æ‰§è¡Œæ—¶é—´ä¸º 1 æ¯«ç§’ï¼Œé‚£ä¹ˆè¶…è¿‡ 1000 ä¸ªå…ƒç´ çš„é¡ºåºæŸ¥è¯¢éœ€è¦ 1 ç§’çš„æ—¶é—´æ‰èƒ½æ‰§è¡Œæ­¤æ“ä½œï¼Œè€Œåœ¨å››æ ¸è®¡ç®—æœºä¸Šï¼Œå¹¶è¡ŒæŸ¥è¯¢å¯èƒ½åªéœ€è¦ 250 æ¯«ç§’å°±èƒ½å®Œæˆã€‚ è¿™å°±äº§ç”Ÿ 750 æ¯«ç§’çš„åŠ é€Ÿã€‚ å¦‚æœå‡½æ•°æ‰§è¡Œæ¯ä¸ªå…ƒç´ éœ€è¦ 1 ç§’ï¼Œå°±ä¼šäº§ç”Ÿ 750 ç§’çš„åŠ é€Ÿã€‚ å¦‚æœå§”æ‰˜æˆæœ¬å¾ˆé«˜ï¼ŒPLINQ å¯èƒ½ä¼šè®©é€Ÿåº¦æ˜¾è‘—æå‡ï¼Œå‰ææ˜¯æºé›†åˆä¸­åªæœ‰å‡ é¡¹ã€‚ ç›¸åï¼ŒåŒ…å«æœ€ç®€å•çš„å§”æ‰˜çš„å°å‹æºé›†åˆé€šå¸¸ä¸é€‚åˆæ‰§è¡Œ PLINQã€‚
åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼ŒqueryA å¯èƒ½å¾ˆé€‚åˆæ‰§è¡Œ PLINQï¼Œå‰ææ˜¯å®ƒçš„ Select å‡½æ•°æ¶‰åŠå¾ˆå¤šå·¥ä½œã€‚ queryB å¯èƒ½ä¸é€‚åˆæ‰§è¡Œ PLINQï¼Œå› ä¸º Select è¯­å¥ä¸­æ²¡æœ‰è¶³å¤Ÿå¤šçš„å·¥ä½œï¼Œå¹¶è¡Œå¼€é”€ä¼šæŠµæ¶ˆå¤§éƒ¨åˆ†æˆ–å…¨éƒ¨åŠ é€Ÿã€‚



```
var queryA = from num in numberList.AsParallel()  
             select ExpensiveFunction(num); //good for PLINQ  

var queryB = from num in numberList.AsParallel()  
             where num % 2 > 0  
             select num; //not as good for PLINQ  

```

2. ç³»ç»Ÿä¸Šçš„é€»è¾‘å†…æ ¸æ•°é‡ï¼ˆå¹¶è¡Œåº¦ï¼‰ã€‚
è¿™ä¸€ç‚¹æ˜¯ä¸Šä¸€éƒ¨åˆ†çš„å¿…ç„¶ç»“æœï¼Œåœ¨å…·æœ‰æ›´å¤šå†…æ ¸çš„è®¡ç®—æœºä¸Šï¼Œé€‚åˆå¹¶è¡ŒæŸ¥è¯¢è¿è¡Œå¾—æ›´å¿«ï¼Œè¿™æ˜¯å› ä¸ºå¯ä»¥åœ¨æ›´å¤šå¹¶å‘çº¿ç¨‹ä¹‹é—´åˆ’åˆ†å·¥ä½œã€‚ åŠ é€Ÿæ€»é‡å–å†³äºæŸ¥è¯¢æ•´ä½“å·¥ä½œçš„å¹¶è¡Œåº¦ç™¾åˆ†æ¯”ã€‚ ä¸è¿‡ï¼Œä¸è¦è®¤ä¸ºæ‰€æœ‰æŸ¥è¯¢åœ¨å…«æ ¸è®¡ç®—æœºä¸Šçš„è¿è¡Œé€Ÿåº¦éƒ½æ˜¯åœ¨å››æ ¸è®¡ç®—æœºä¸Šçš„ä¸¤å€ã€‚ ä¼˜åŒ–æŸ¥è¯¢ä»¥å®ç°æœ€ä½³æ€§èƒ½æ—¶ï¼Œè¯·åŠ¡å¿…åœ¨å…·æœ‰ä¸åŒæ•°é‡å†…æ ¸çš„è®¡ç®—æœºä¸Šåº¦é‡å®é™…ç»“æœã€‚ è¿™ä¸€ç‚¹ä¸ç¬¬ 1 ç‚¹ç›¸å…³ï¼šéœ€è¦æ›´å¤§çš„æ•°æ®é›†ï¼Œæ‰èƒ½åˆ©ç”¨æ›´å¤šçš„è®¡ç®—èµ„æºã€‚
3. æ“ä½œçš„æ•°é‡å’Œç§ç±»ã€‚
å¦‚æœæœ‰å¿…è¦ç»´æŠ¤æºåºåˆ—ä¸­çš„å…ƒç´ é¡ºåºï¼ŒPLINQ æä¾› AsOrdered è¿ç®—ç¬¦ã€‚ è™½ç„¶æ’åºæœ‰ç›¸å…³æˆæœ¬ï¼Œä½†æ­¤æˆæœ¬é€šå¸¸è¿˜ç®—ä½ã€‚ GroupBy å’Œ Join æ“ä½œåŒæ ·ä¹Ÿä¼šäº§ç”Ÿå¼€é”€ã€‚ å¦‚æœå…è®¸æŒ‰ä»»æ„é¡ºåºå¤„ç†æºé›†åˆä¸­çš„å…ƒç´ ï¼Œå¹¶åœ¨å‡†å¤‡å°±ç»ªåç«‹å³å°†å®ƒä»¬ä¼ é€’ç»™ä¸‹ä¸€ä¸ªè¿ç®—ç¬¦ï¼ŒPLINQ çš„æ€§èƒ½æœ€ä½³ã€‚
4. æŸ¥è¯¢æ‰§è¡Œå½¢å¼ã€‚
è‹¥è¦é€šè¿‡è°ƒç”¨ ToArray æˆ– ToList å­˜å‚¨æŸ¥è¯¢ç»“æœï¼Œæ‰€æœ‰å¹¶è¡Œçº¿ç¨‹çš„ç»“æœéƒ½å¿…é¡»åˆå¹¶åˆ°ä¸€ä¸ªæ•°æ®ç»“æ„ä¸­ã€‚ è¿™å°±æ¶‰åŠä¸å¯é¿å…çš„è®¡ç®—æˆæœ¬ã€‚ åŒæ ·ï¼Œå¦‚æœä½¿ç”¨ foreachï¼ˆVisual Basic ä¸­çš„ For Eachï¼‰å¾ªç¯æ¥å¾ªç¯è®¿é—®ç»“æœï¼Œå·¥ä½œçº¿ç¨‹çš„ç»“æœå¿…é¡»ä¸²è¡ŒåŒ–åˆ°æšä¸¾å™¨çº¿ç¨‹ã€‚ ä¸è¿‡ï¼Œå¦‚æœåªæƒ³æ ¹æ®æ¯ä¸ªçº¿ç¨‹çš„ç»“æœæ‰§è¡ŒæŸæ“ä½œï¼Œå¯ä»¥ä½¿ç”¨ ForAll æ–¹æ³•å¯¹å¤šä¸ªçº¿ç¨‹æ‰§è¡Œæ­¤æ“ä½œã€‚
5. åˆå¹¶é€‰é¡¹ç±»å‹ã€‚
PLINQ å¯ä»¥é…ç½®ä¸ºç¼“å†²è¾“å‡ºå¹¶åœ¨ç”Ÿæˆæ•´ä¸ªç»“æœé›†ååˆ†å—åŒºç”Ÿæˆæˆ–ä¸€æ¬¡æ€§å…¨éƒ¨ç”Ÿæˆï¼Œä¹Ÿå¯ä»¥é…ç½®ä¸ºåœ¨å„ä¸ªç»“æœç”Ÿæˆæ—¶æµå¼ä¼ è¾“å®ƒä»¬ã€‚ å‰ä¸€ä¸ªå¯¼è‡´æ€»ä½“æ‰§è¡Œæ—¶é—´å‡å°‘ï¼Œåä¸€ä¸ªå¯¼è‡´æ‰€ç”Ÿæˆå…ƒç´ ä¹‹é—´çš„å»¶è¿Ÿå‡å°‘ã€‚ å°½ç®¡åˆå¹¶é€‰é¡¹ä¸ä¸€å®šä¼šå¯¹æ€»ä½“æŸ¥è¯¢æ€§èƒ½é€ æˆé‡å¤§å½±å“ï¼Œä½†å®ƒä»¬å¯èƒ½ä¼šå½±å“æ„ŸçŸ¥æ€§èƒ½ï¼Œå› ä¸ºå®ƒä»¬æ§åˆ¶ç”¨æˆ·åœ¨çœ‹åˆ°ç»“æœå‰å¿…é¡»ç­‰å¾…çš„æ—¶é—´ã€‚


### é€‰æ‹©ä½¿ç”¨æ¨¡å‹



```
var source = Enumerable.Range(1, 10000);

// Opt in to PLINQ with AsParallel.
var evenNums = from num in source.AsParallel()
               where num % 2 == 0
               select num;
Console.WriteLine("{0} even numbers out of {1} total",
                  evenNums.Count(), source.Count());
// The example displays the following output:
//       5000 even numbers out of 10000 total

```

AsParallel æ‰©å±•æ–¹æ³•å°†åç»­æŸ¥è¯¢è¿ç®—ç¬¦ï¼ˆåœ¨æ­¤ç¤ºä¾‹ä¸­ä¸º where å’Œ selectï¼‰ç»‘å®šåˆ° System.Linq.ParallelEnumerable å®ç°ã€‚


### æ‰§è¡Œæ¨¡å¼


é»˜è®¤æƒ…å†µä¸‹ï¼ŒPLINQ æ˜¯ä¿å®ˆçš„ã€‚ åœ¨è¿è¡Œæ—¶ï¼ŒPLINQ åŸºç¡€ç»“æ„å°†åˆ†ææŸ¥è¯¢çš„æ€»ä½“ç»“æ„ã€‚ å¦‚æœé€šè¿‡å¹¶è¡Œå¯èƒ½ä¼šæé«˜æŸ¥è¯¢é€Ÿåº¦ï¼ŒPLINQ åˆ™å°†æºåºåˆ—åˆ†åŒºä¸ºå¯ä»¥åŒæ—¶è¿è¡Œçš„ä»»åŠ¡ã€‚ å¦‚æœå¹¶è¡ŒåŒ–æŸ¥è¯¢ä¸å®‰å…¨ï¼ŒPLINQ åˆ™åªä¼šæŒ‰é¡ºåºè¿è¡ŒæŸ¥è¯¢ã€‚ å¦‚æœ PLINQ å¯ä»¥åœ¨å¯èƒ½ä¼šè¾ƒæ˜‚è´µçš„å¹¶è¡Œç®—æ³•æˆ–æˆæœ¬è¾ƒä½çš„é¡ºåºç®—æ³•ä¹‹é—´è¿›è¡Œé€‰æ‹©ï¼Œå®ƒä¼šé»˜è®¤é€‰æ‹©é¡ºåºç®—æ³•ã€‚ å¯ä»¥ä½¿ç”¨ WithExecutionMode æ–¹æ³•å’Œ System.Linq.ParallelExecutionMode æšä¸¾æŒ‡ç¤º PLINQ é€‰æ‹©å¹¶è¡Œç®—æ³•ã€‚ å¦‚æœä½ é€šè¿‡æµ‹è¯•å’Œæµ‹é‡çŸ¥é“ç‰¹å®šæŸ¥è¯¢ä»¥å¹¶è¡Œæ–¹å¼æ‰§è¡Œå¾—æ›´å¿«æ—¶ï¼Œæ­¤åšæ³•éå¸¸æœ‰ç”¨ã€‚


### å¹¶è¡Œåº¦


é»˜è®¤æƒ…å†µä¸‹ï¼ŒPLINQ ä½¿ç”¨ä¸»æœºè®¡ç®—æœºä¸Šçš„æ‰€æœ‰å¤„ç†å™¨ã€‚ å¯ä»¥ä½¿ç”¨ WithDegreeOfParallelism æ–¹æ³•æŒ‡ç¤º PLINQ ä½¿ç”¨ä¸è¶…è¿‡æŒ‡å®šæ•°é‡çš„å¤„ç†å™¨ã€‚ å½“ä½ è¦ç¡®ä¿è®¡ç®—æœºä¸Šè¿è¡Œçš„å…¶ä»–è¿›ç¨‹æ”¶åˆ°ä¸€å®šçš„ CPU æ—¶é—´é‡æ—¶ï¼Œæ­¤åšæ³•å°†éå¸¸æœ‰ç”¨ã€‚ ä¸‹é¢çš„ç‰‡æ®µå°†æŸ¥è¯¢é™åˆ¶ä¸ºæœ€å¤šä½¿ç”¨ä¸¤ä¸ªå¤„ç†å™¨ã€‚



```
var query = from item in source.AsParallel().WithDegreeOfParallelism(2)
            where Compute(item) > 42
            select item;

```

åœ¨æŸ¥è¯¢è¦æ‰§è¡Œå¤§é‡éå—è®¡ç®—é™åˆ¶çš„å·¥ä½œï¼ˆå¦‚æ–‡ä»¶ I/Oï¼‰çš„æƒ…å†µä¸‹ï¼Œæœ€å¥½æŒ‡å®šæ¯”è®¡ç®—æœºä¸Šçš„å†…æ ¸æ•°è¦å¤§çš„å¹¶è¡Œåº¦ã€‚


### å·²æ’åºå’Œæœªæ’åºçš„å¹¶è¡ŒæŸ¥è¯¢


åœ¨æŸäº›æŸ¥è¯¢ä¸­ï¼Œä¸€ä¸ªæŸ¥è¯¢è¿ç®—ç¬¦å¿…é¡»äº§ç”Ÿä¿ç•™æºåºåˆ—æ’åºçš„ç»“æœã€‚ ä¸ºæ­¤ï¼ŒPLINQ æä¾›äº† AsOrdered è¿ç®—ç¬¦ã€‚ AsOrdered ä¸åŒäº AsSequentialã€‚ å°½ç®¡ä»å¹¶è¡Œå¤„ç† AsOrdered åºåˆ—ï¼Œä½†ä¼šç¼“å†²å’Œæ’åºå®ƒçš„ç»“æœã€‚ ç”±äºé¡ºåºæš‚ç•™é€šå¸¸æ¶‰åŠé¢å¤–çš„å·¥ä½œï¼Œå› æ­¤å¤„ç† AsOrdered åºåˆ—å¯èƒ½æ¯”å¤„ç†é»˜è®¤ AsUnordered åºåˆ—æ›´æ…¢ã€‚ ç‰¹å®šçš„å·²æ’åºå¹¶è¡Œæ“ä½œæ˜¯å¦æ¯”æ“ä½œçš„é¡ºåºç‰ˆæœ¬æ›´å¿«å–å†³äºè®¸å¤šå› ç´ ã€‚


ä¸‹é¢çš„ä»£ç ç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•é€‰æ‹©ä½¿ç”¨é¡ºåºä¿ç•™ã€‚



```
var evenNums =
    from num in numbers.AsParallel().AsOrdered()
    where num % 2 == 0
    select num;

```

### å¹¶è¡Œå’Œé¡ºåºæŸ¥è¯¢


æŸäº›æ“ä½œè¦æ±‚æŒ‰é¡ºåºæä¾›æºæ•°æ®ã€‚ å¿…è¦æ—¶ï¼ŒParallelEnumerable æŸ¥è¯¢è¿ç®—ç¬¦è‡ªåŠ¨è¿˜åŸä¸ºé¡ºåºæ¨¡å¼ã€‚ å¯¹äºè¦æ±‚é¡ºåºæ‰§è¡Œçš„ç”¨æˆ·å®šä¹‰çš„æŸ¥è¯¢è¿ç®—ç¬¦å’Œç”¨æˆ·å§”æ‰˜ï¼ŒPLINQ æä¾›äº† AsSequential æ–¹æ³•ã€‚ ä½¿ç”¨ AsSequential æ—¶ï¼ŒæŸ¥è¯¢ä¸­çš„æ‰€æœ‰åç»­è¿ç®—ç¬¦éƒ½ä¼šé¡ºåºæ‰§è¡Œï¼Œç›´åˆ°å†æ¬¡è°ƒç”¨ AsParallelã€‚


### å¼‚å¸¸


å½“ä¸€ä¸ª PLINQ æŸ¥è¯¢æ‰§è¡Œæ—¶ï¼Œå¯èƒ½ä¼šåŒæ—¶ä»ä¸åŒçš„çº¿ç¨‹å¼•å‘å¤šä¸ªå¼‚å¸¸ã€‚ æ­¤å¤–ï¼Œå¤„ç†å¼‚å¸¸çš„ä»£ç å¯èƒ½ä¸å¼•å‘å¼‚å¸¸çš„ä»£ç å¤„äºä¸åŒçš„çº¿ç¨‹ä¸Šã€‚ PLINQ ä½¿ç”¨ AggregateException ç±»å‹å°è£…æŸ¥è¯¢æŠ›å‡ºçš„æ‰€æœ‰å¼‚å¸¸ï¼Œå¹¶å°†è¿™äº›å¼‚å¸¸å°é€å›è°ƒç”¨çº¿ç¨‹ã€‚ åœ¨è°ƒç”¨çº¿ç¨‹ä¸Šï¼Œåªéœ€è¦ä¸€ä¸ª try\-catch å—ã€‚ ä¸è¿‡ï¼Œå¯ä»¥å¾ªç¯è®¿é—®åœ¨ AggregateException ä¸­å°è£…çš„æ‰€æœ‰å¼‚å¸¸ï¼Œå¹¶æ•è·ä»»ä½•å¯ä»¥å®‰å…¨æ¢å¤çš„å¼‚å¸¸ã€‚ åœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šæŠ›å‡ºä¸€äº›æœªåœ¨ AggregateException ä¸­åŒ…è£…ã€ThreadAbortException ä¹Ÿæ²¡æœ‰è¿›è¡ŒåŒ…è£…çš„å¼‚å¸¸ã€‚


å¦‚æœå…è®¸å¼‚å¸¸å‘ä¸Šå†’æ³¡å›åˆ°è”æ¥çº¿ç¨‹ï¼Œåˆ™æŸ¥è¯¢ä¹Ÿè®¸å¯ä»¥åœ¨å¼•å‘å¼‚å¸¸åç»§ç»­å¤„ç†ä¸€äº›é¡¹ã€‚


### è‡ªå®šä¹‰åˆ†åŒºç¨‹åº


åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡ç¼–å†™åˆ©ç”¨æºæ•°æ®çš„æŸäº›ç‰¹å¾çš„è‡ªå®šä¹‰åˆ†åŒºç¨‹åºæ¥æé«˜æŸ¥è¯¢æ€§èƒ½ã€‚ åœ¨æŸ¥è¯¢ä¸­ï¼Œè‡ªå®šä¹‰åˆ†åŒºç¨‹åºæœ¬èº«æ˜¯è¢«æŸ¥è¯¢çš„å¯æšä¸¾å¯¹è±¡ã€‚


\-\-


# éªŒè¯ä¸æµ‹è¯•


ä¸‹æ–‡æˆ‘å°†ä»‹ç»å¦‚ä½•å¿«é€Ÿéƒ¨ç½²å‡è®¯å¨åœ¨çº¿å®¢æœç³»ç»Ÿï¼Œæ¥æµ‹è¯•éªŒè¯å¹¶è¡ŒæŸ¥è¯¢æŠ€æœ¯çš„æ•ˆæœã€‚


* CentOS å®‰è£…é…ç½® MySQL æ•°æ®åº“ï¼Œåˆ›å»ºæ•°æ®åº“ï¼Œæ‰§è¡Œè„šæœ¬åˆ›å»ºè¡¨ç»“æ„ã€‚
* å®‰è£… Nginxï¼Œåå‘ä»£ç†åˆ°å®¢æœç³»ç»ŸæœåŠ¡ç«¯ï¼Œå¹¶è®¾ç½®å¼€æœºè‡ªå¯åŠ¨
* å®‰è£… .net core ï¼Œéƒ¨ç½²å®¢æœç³»ç»Ÿå¹¶å¼€æœºè‡ªå¯åŠ¨


æˆ‘è¯¦ç»†åˆ—å‡ºäº†éœ€è¦æ‰§è¡Œçš„å‘½ä»¤çš„å…¨è¿‡ç¨‹ï¼Œè·Ÿéšæœ¬æ–‡å¯ä»¥åœ¨ 30 åˆ†é’Ÿå†…å®Œæˆéƒ¨ç½²ã€‚


### å®Œæ•´ç§æœ‰åŒ–åŒ…ä¸‹è½½åœ°å€



> ğŸ’¾ [https://kf.shengxunwei.com/freesite.zip](https://github.com)


### å½“å‰ç‰ˆæœ¬ä¿¡æ¯


å‘å¸ƒæ—¥æœŸï¼š 2024\-9\-18
æ•°æ®åº“ç‰ˆæœ¬ï¼š 20240413b
æœåŠ¡å™¨ç‰ˆæœ¬ï¼š 1\.15\.5\.0
å®¢æœç¨‹åºç‰ˆæœ¬ï¼š 1\.15\.19\.0
æ›´æ–°ç¨‹åºç‰ˆæœ¬ï¼š 1\.2\.1\.0
èµ„æºç«™ç‚¹ç‰ˆæœ¬ï¼š 1\.7\.20\.0
Webç®¡ç†åå°ç‰ˆæœ¬ï¼š 2\.3\.1


![](https://docs-api.shengxunwei.com/StaticFiles/Upload/15ea0fe9-0392-4acc-bc5a-12735d16d537.png)


![](https://docs-api.shengxunwei.com/StaticFiles/Upload/1d43bed9-b5a8-4941-a2c6-56ef4e3152cf.png)


# å‡†å¤‡æ“ä½œç³»ç»Ÿ


* æœ¬æ–‡ä»¥ CentOS 7\.9 ä¸ºä¾‹è¿›è¡Œè¯´æ˜ï¼Œå…¶å®ƒç‰ˆæœ¬çš„ Linux å®‰è£…é…ç½®è¿‡ç¨‹å¤§åŒå°å¼‚ã€‚


## å¼€æ”¾é˜²ç«å¢™ç«¯å£


å®¢æœç³»ç»Ÿé»˜è®¤ä½¿ç”¨ 9527 ç«¯å£è¿›è¡Œé€šä¿¡ï¼Œå¦‚æœå¼€å¯äº†é˜²ç«å¢™ï¼Œè¯·åœ¨é˜²ç«å¢™ä¸­å¼€æ”¾æ­¤ç«¯å£ã€‚


ä¹Ÿå¯ä»¥æ›´æ”¹ä¸ºå…¶å®ƒå¯ç”¨ç«¯å£å·ï¼Œåœ¨åç»­é…ç½®å®¢æœç³»ç»ŸæœåŠ¡ç«¯ç¨‹åºæ—¶è¦åšå¯¹åº”çš„ä¿®æ”¹ã€‚



> è¯·ç¡®ä¿æ‚¨æ‰€ä½¿ç”¨çš„ä¸»æœºæœåŠ¡å•†æä¾›çš„é˜²ç«å¢™æœåŠ¡ä¸­ï¼Œä¹Ÿå¼€æ”¾äº†å¯¹åº”ç«¯å£ã€‚å¦‚é˜¿é‡Œäº‘æœåŠ¡å™¨éœ€è¦åœ¨å®‰å…¨ç»„è§„åˆ™ä¸­é…ç½®ã€‚


# å®‰è£… MySQL æ•°æ®åº“å¼•æ“


1. ä¸‹è½½
`wget http://dev.mysql.com/get/mysql80-community-release-el7-10.noarch.rpm`



> å¦‚æœæç¤º command not foundï¼Œåˆ™å…ˆæ‰§è¡Œ `yum -y install wget` å®‰è£…
> 
> 
> æ³¨æ„ï¼šæ­¤ä¸‹è½½åœ°å€é€‚ç”¨äº CentOS 7 ï¼Œå¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ CentOS 8ï¼Œè¯·å°† rpm åŒ…åæ›´æ¢ä¸º `mysql80-community-release-el8-8.noarch.rpm`
> ä¸åŒç‰ˆæœ¬çš„ MySQL Community ç‰ˆæœ¬ä¸‹è½½è¯·å‚é˜…ï¼š[https://dev.mysql.com/downloads/](https://github.com)


2. å®‰è£…
`rpm -ivh mysql80-community-release-el7-10.noarch.rpm`
`yum install mysql-community-server -y`
3. æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ
`rpm -qa | grep mysql`


è¾“å‡ºç±»ä¼¼ï¼š
mysql\-community\-client\-plugins\-8\.0\.34\-1\.el7\.x86\_64
mysql\-community\-libs\-8\.0\.34\-1\.el7\.x86\_64
mysql\-community\-icu\-data\-files\-8\.0\.34\-1\.el7\.x86\_64
mysql\-community\-server\-8\.0\.34\-1\.el7\.x86\_64
mysql80\-community\-release\-el7\-10\.noarch
mysql\-community\-common\-8\.0\.34\-1\.el7\.x86\_64
mysql\-community\-client\-8\.0\.34\-1\.el7\.x86\_64


4. å¯åŠ¨
`sudo systemctl start mysqld`
5. è®¾ç½®å¼€æœºè‡ªå¯åŠ¨
`sudo systemctl enable mysqld`
6. æŸ¥çœ‹å®‰è£…æ—¶ç”Ÿæˆçš„ä¸´æ—¶å¯†ç 
`sudo cat /var/log/mysqld.log |grep password`
7. ä½¿ç”¨ä¸´æ—¶å¯†ç è¿æ¥ MySQL
`mysql -uroot -p`
8. ä¿®æ”¹ root å¯†ç 
`alter user root@localhost identified with mysql_native_password by 'ä½ çš„å¯†ç ';`



> å¯†ç å¿…é¡»åŒ…å«å¤§å†™å­—æ¯ã€å°å†™å­—æ¯ã€æ•°å­—ã€ç‰¹æ®Šç¬¦å·


9. é€€å‡º MySQL è¿æ¥
`exit`


# å®‰è£… Nginx


1. å®‰è£… Nginx
`sudo yum install -y nginx`



> å¦‚æœæç¤º No package nginx availableï¼Œåˆ™å…ˆæ‰§è¡Œ
> 
> 
> * `yum install epel-release -y`



> å®‰è£…æˆåŠŸåï¼š
> å¯æ‰§è¡Œæ–‡ä»¶ä¸ºï¼š/usr/sbin/nginx
> é»˜è®¤çš„ç½‘ç«™ç›®å½•ä¸ºï¼š /usr/share/nginx/html
> é»˜è®¤çš„é…ç½®æ–‡ä»¶ä¸ºï¼š/etc/nginx/nginx.conf
> è‡ªå®šä¹‰é…ç½®æ–‡ä»¶ç›®å½•ä¸º: /etc/nginx/conf.d/


2. å¯åŠ¨ Nginx
`systemctl start nginx`
3. å¯ç”¨å¼€æœºå¯åŠ¨ Nginx
`systemctl enable nginx`


# å®‰è£… .Net Core


1. é…ç½®å®‰è£…æº
`sudo rpm -Uvh https://packages.microsoft.com/config/rhel/7/packages-microsoft-prod.rpm`
2. å®‰è£…
`sudo dnf install dotnet-sdk-3.1`



> å¦‚æœæç¤º command not foundï¼Œåˆ™å…ˆæ‰§è¡Œ
> 
> 
> * `yum -y install dnf`


3. ç¡®è®¤å®‰è£…æˆåŠŸ


åœ¨å‘½ä»¤è¡Œè¾“å…¥ `dotnet` çœ‹åˆ°ç±»ä¼¼å¦‚ä¸‹æç¤ºï¼Œè¡¨ç¤ºå®‰è£…æˆåŠŸã€‚


![](https://docs-api.shengxunwei.com/StaticFiles/Upload/568be32d-daf9-4665-81b8-7b82d857a694.jpg)


# é…ç½®æœåŠ¡å™¨ä¸»ç¨‹åº


è¯·ç¡®è®¤å·²ç»å®Œæˆäº†å¯¹æœåŠ¡å™¨ä¸»ç¨‹åºé…ç½®æ–‡ä»¶çš„é…ç½®ã€‚
å‚é˜…ï¼š[ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·é…ç½®æœåŠ¡å™¨ç«¯ç¨‹åº](https://github.com)


## è®¿å®¢èŠå¤©æµ‹è¯•


ç™»å½•å®¢æœç«¯ä»¥åï¼Œç”¨æµè§ˆå™¨æ‰“å¼€ä½ çš„èµ„æºç«™ç‚¹åŸŸåä¸‹çš„èŠå¤©é¡µé¢ï¼Œå¦‚ï¼š



> kf\-resource.shengxunwei.com/WebChat/WebChat.html?sitecode\=freesite


å¼€å§‹èŠå¤©ã€‚


![](https://docs-api.shengxunwei.com/StaticFiles/Upload/295287db-7946-4f5c-a624-65a2e08a9782.JPG)


![](https://docs-api.shengxunwei.com/StaticFiles/Upload/564f10a0-9b2e-4048-a975-3cb4c7d6d065.JPG)


## å‘å¸ƒ


å°†é…ç½®å¥½çš„å®¢æœç«¯ç¨‹åº Shell ç›®å½•ï¼Œå‹ç¼©æˆ–æ‰“åŒ…åˆ†å‘ç»™å®¢æœä½¿ç”¨å³å¯ã€‚


## é›†æˆ


* [é›†æˆåˆ°æ‚¨çš„ç½‘ç«™](https://github.com):[westworldåŠ é€Ÿ](https://tianchuang88.com)
* [é›†æˆåˆ°æ‚¨çš„æ‰‹æœºAPP](https://github.com)
* [é›†æˆåˆ°æ‚¨çš„å…¬ä¼—å·ç­‰å¹³å°](https://github.com)
* [æ·±åº¦é›†æˆï¼šä¼ é€’æ‚¨çš„è®¿å®¢æ•°æ®åˆ°å®¢æœç³»ç»Ÿ](https://github.com)


